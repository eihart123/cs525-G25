/**
 * @license
 * Copyright 2022-2025 Matter.js Authors
 * SPDX-License-Identifier: Apache-2.0
 */
import { relative } from "node:path";
import {
  Application,
  ContainerReflection,
  Converter,
  DeclarationReflection,
  LogLevel,
  ReflectionFlag,
  ReflectionKind
} from "typedoc";
import { isFile } from "../util/file.js";
import { Graph } from "./graph.js";
const PLUGINS = ["typedoc-github-theme"];
const OUTPUT_PATH = "build/docs/docs";
const THEME_OPTIONS = {
  themeColor: "#cb9820"
  // TODO - add service links
  //   GitHub: "https://github.com/project-chip/matter.js",
  //   Discord: "https://discord.gg/ujmRNrhDuW",
  //   NPM: "https://www.npmjs.com/package/@project-chip/matter.js",
};
async function buildDocs(pkg, progress) {
  const modules = pkg.sourceModules;
  const entryPoints = Array();
  const basePath = pkg.root.path;
  for (const name in modules) {
    const path = modules[name];
    if (path.endsWith(".json")) {
      continue;
    }
    if (isFile(path)) {
      if (!entryPoints.includes(path)) {
        entryPoints.push(path);
      }
    } else {
      throw new Error(`No source found for module ${name} path ${modules[name]}`);
    }
  }
  const app = await createApplication({
    excludeExternals: true,
    entryPoints,
    tsconfig: pkg.resolve("tsconfig.json"),
    basePath,
    skipErrorChecking: true,
    // Removes a couple hundred MB of tabs so worth uncommenting at some point
    //pretty: false,
    readme: "none"
  });
  instrumentForEntrypointRepair(app, pkg);
  const analysis = new ReflectionAnalysis();
  app.converter.on(Converter.EVENT_CREATE_DECLARATION, () => {
    progress.refresh();
  });
  app.converter.on(Converter.EVENT_RESOLVE, () => {
    progress.refresh();
  });
  const reflection = await loadReflections(app, pkg);
  analyzeReflections(reflection, analysis);
  repairReflections(analysis);
  await app.generateJson(reflection, pkg.resolve("build/docs.json"));
}
function reflectionsPath(pkg) {
  const path = pkg.resolve("build/docs.json");
  if (isFile(path)) {
    return path;
  }
}
function instrumentForEntrypointRepair(app, pkg) {
  const baseGetEntryPoints = app.getEntryPoints.bind(app);
  const mapping = naiveToRealNamesFor(pkg);
  app.getEntryPoints = () => {
    const list = baseGetEntryPoints();
    if (list === void 0) {
      return list;
    }
    for (const ep of list) {
      const realName = mapping[ep.displayName];
      if (realName === void 0) {
        throw new Error(`Typedoc naive module name "${ep.displayName}" is unmapped`);
      }
      ep.displayName = realName;
    }
    return list;
  };
}
function naiveToRealNamesFor(pkg) {
  const modules = pkg.sourceModules;
  const mapping = {};
  const packagePrefix = `${pkg.name}/`;
  const basePath = pkg.root.path;
  for (const name in modules) {
    const path = modules[name];
    if (path.endsWith(".json")) {
      continue;
    }
    const naiveName = relative(basePath, path).replace(/.(?:ts|js|mjs|cjs)$/, "").replace(/\/index$/, "");
    if (name.startsWith(packagePrefix)) {
      mapping[naiveName] = name.substring(packagePrefix.length);
    } else if (name === pkg.name) {
      mapping[naiveName] = ".";
    } else {
      mapping[naiveName] = name;
    }
  }
  return mapping;
}
async function mergeDocs(pkg) {
  const entryPoints = Array();
  const root = pkg.root;
  if (root.isWorkspace) {
    const graph = await Graph.load(root);
    if (graph === void 0) {
      throw new Error(`Internal: ${pkg.name} has workspaces but no graph`);
    }
    for (const node of graph.nodes) {
      const path = reflectionsPath(node.pkg);
      if (path) {
        entryPoints.push(path);
      }
    }
    if (!entryPoints.length) {
      throw new Error(`No reflections detected in workspace ${pkg.name}`);
    }
  } else {
    const path = reflectionsPath(pkg);
    if (path === void 0) {
      throw new Error(`No reflections present for ${pkg.name}`);
    }
    entryPoints.push(path);
  }
  const app = await createApplication({
    entryPoints,
    entryPointStrategy: "merge",
    ...THEME_OPTIONS
  });
  const reflection = await loadReflections(app, pkg);
  await app.generateDocs(reflection, pkg.resolve(OUTPUT_PATH));
}
async function createApplication(options) {
  return await Application.bootstrapWithPlugins({
    plugin: PLUGINS,
    logLevel: LogLevel.Warn,
    ...options
  });
}
async function loadReflections(app, pkg) {
  const reflection = await app.convert();
  if (reflection === void 0) {
    throw new Error(`Project ${pkg.path} produced no documentation`);
  }
  return reflection;
}
class ReflectionAnalysis {
  // TODO - need to populate this during analysis so we can warn; will replace typedoc-plugin-missing-exports
  unexportedReference = /* @__PURE__ */ new Set();
  mergeWithParent = /* @__PURE__ */ new Set();
  mergeInto = /* @__PURE__ */ new Map();
}
function analyzeReflections(node, analysis) {
  visit(node, (subject) => {
    const children = childrenOf(subject);
    const mergeable = {};
    const namespaces = /* @__PURE__ */ new Set();
    for (const child of children) {
      if (child.kindOf(ReflectionKind.ClassOrInterface | ReflectionKind.Function)) {
        mergeable[child.name] = child;
      } else if (child.kindOf(ReflectionKind.Namespace)) {
        namespaces.add(child);
      }
    }
    for (const ns of namespaces) {
      const mergeInto2 = mergeable[ns.name];
      if (mergeInto2) {
        analysis.mergeInto.set(ns, mergeInto2);
      }
    }
  });
}
function repairReflections(analysis) {
  for (const toMerge of analysis.mergeWithParent) {
    if (toMerge.parent instanceof DeclarationReflection) {
      mergeInto(toMerge, toMerge.parent);
    }
  }
  for (const [toMerge, into] of analysis.mergeInto.entries()) {
    mergeInto(toMerge, into);
  }
}
function moveNode(subject, into) {
  const from = subject.parent;
  if (from === into) {
    return;
  }
  if (from) {
    from.removeChild(subject);
  }
  into.addChild(subject);
  subject.parent = into;
  if (from.kindOf(ReflectionKind.Namespace) && into.kindOf(ReflectionKind.ClassOrInterface) && subject.kindOf(ReflectionKind.SomeValue)) {
    subject.flags.setFlag(ReflectionFlag.Static, true);
    if (subject.kindOf(ReflectionKind.Variable)) {
      subject.kind = ReflectionKind.Property;
    }
  }
}
function mergeInto(from, into) {
  const children = childrenOf(from);
  while (children.length) {
    moveNode(children[0], into);
  }
  from.parent?.removeChild(from);
}
function childrenOf(node) {
  if (node instanceof ContainerReflection) {
    if (node.children === void 0) {
      node.children = [];
    }
    return node.children;
  }
  return [];
}
function visit(node, visitor) {
  visitor(node);
  for (const child of childrenOf(node)) {
    visit(child, visitor);
  }
}
export {
  buildDocs,
  mergeDocs
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL2J1aWxkaW5nL2RvY3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyLTIwMjUgTWF0dGVyLmpzIEF1dGhvcnNcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHsgcmVsYXRpdmUgfSBmcm9tIFwibm9kZTpwYXRoXCI7XG5pbXBvcnQge1xuICAgIEFwcGxpY2F0aW9uLFxuICAgIENvbnRhaW5lclJlZmxlY3Rpb24sXG4gICAgQ29udmVydGVyLFxuICAgIERlY2xhcmF0aW9uUmVmbGVjdGlvbixcbiAgICBMb2dMZXZlbCxcbiAgICBSZWZsZWN0aW9uLFxuICAgIFJlZmxlY3Rpb25GbGFnLFxuICAgIFJlZmxlY3Rpb25LaW5kLFxuICAgIFR5cGVEb2NPcHRpb25zLFxufSBmcm9tIFwidHlwZWRvY1wiO1xuaW1wb3J0IHsgaXNGaWxlIH0gZnJvbSBcIi4uL3V0aWwvZmlsZS5qc1wiO1xuaW1wb3J0IHsgUGFja2FnZSB9IGZyb20gXCIuLi91dGlsL3BhY2thZ2UuanNcIjtcbmltcG9ydCB7IFByb2dyZXNzIH0gZnJvbSBcIi4uL3V0aWwvcHJvZ3Jlc3MuanNcIjtcbmltcG9ydCB7IEdyYXBoIH0gZnJvbSBcIi4vZ3JhcGguanNcIjtcblxuLy8gTk9URSAtIHRoaXMgaXMgYSBcImJlc3QgYXR0ZW1wdFwiIGF0IGRvYyBnZW5lcmF0aW9uIHZpYSB0eXBlc2NyaXB0LiAgVGhlIHJlc3VsdCBpcyBub3QgYWxsIHRoYXQgZ3JlYXQ7IHR5cGVkb2MgaXMgdG9vXG4vLyBsaW1pdGVkIGZvciBvdXIgY29tcGxleCBBUEkgc28gd2UncmUgZ29pbmcgdG8gbmVlZCBzb21ldGhpbmcgY3VzdG9tIHRvIGRvIGl0IHJpZ2h0XG5cbmNvbnN0IFBMVUdJTlMgPSBbXCJ0eXBlZG9jLWdpdGh1Yi10aGVtZVwiXSBhcyBzdHJpbmdbXTtcblxuLy8gRG91YmxlIFwiZG9jc1wiIGRpcmVjdG9yaWVzIHNvIHRvcC1sZXZlbCBkaXJlY3RvcnkgY2FuIGJlIGEgR0ggcmVwb3NpdG9yeSB3aXRoIHBhZ2VzIGNvbmZpZ3VyZWQgdW5kZXIgXCJkb2NzXCJcbmNvbnN0IE9VVFBVVF9QQVRIID0gXCJidWlsZC9kb2NzL2RvY3NcIjtcblxuY29uc3QgVEhFTUVfT1BUSU9OUyA9IHtcbiAgICB0aGVtZUNvbG9yOiBcIiNjYjk4MjBcIixcblxuICAgIC8vIFRPRE8gLSBhZGQgc2VydmljZSBsaW5rc1xuICAgIC8vICAgR2l0SHViOiBcImh0dHBzOi8vZ2l0aHViLmNvbS9wcm9qZWN0LWNoaXAvbWF0dGVyLmpzXCIsXG4gICAgLy8gICBEaXNjb3JkOiBcImh0dHBzOi8vZGlzY29yZC5nZy91am1STnJoRHVXXCIsXG4gICAgLy8gICBOUE06IFwiaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQHByb2plY3QtY2hpcC9tYXR0ZXIuanNcIixcbn07XG5cbi8qKlxuICogR2VuZXJhdGUgYnVpbGQvZG9jcy5qc29uIGZvciBhIHNpbmdsZSBwcm9qZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGREb2NzKHBrZzogUGFja2FnZSwgcHJvZ3Jlc3M6IFByb2dyZXNzKSB7XG4gICAgY29uc3QgbW9kdWxlcyA9IHBrZy5zb3VyY2VNb2R1bGVzO1xuXG4gICAgLy8gV2UgcG9pbnQgdHlwZWRvYyBhdCBlYWNoIG9mIG91ciBwdWJsaWMgZXhwb3J0c1xuICAgIGNvbnN0IGVudHJ5UG9pbnRzID0gQXJyYXk8c3RyaW5nPigpO1xuXG4gICAgLy8gSW4gYSB3b3Jrc3BhY2UgdHlwZWRvYyByZXF1aXJlcyBmaWxlcyB0byBiZSByZWxhdGl2ZSB0byB0aGUgd29ya3NwYWNlIGZvciBtZXJnZVxuICAgIGNvbnN0IGJhc2VQYXRoID0gcGtnLnJvb3QucGF0aDtcblxuICAgIGZvciAoY29uc3QgbmFtZSBpbiBtb2R1bGVzKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSBtb2R1bGVzW25hbWVdO1xuICAgICAgICBpZiAocGF0aC5lbmRzV2l0aChcIi5qc29uXCIpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0ZpbGUocGF0aCkpIHtcbiAgICAgICAgICAgIGlmICghZW50cnlQb2ludHMuaW5jbHVkZXMocGF0aCkpIHtcbiAgICAgICAgICAgICAgICBlbnRyeVBvaW50cy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzb3VyY2UgZm91bmQgZm9yIG1vZHVsZSAke25hbWV9IHBhdGggJHttb2R1bGVzW25hbWVdfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYXBwID0gYXdhaXQgY3JlYXRlQXBwbGljYXRpb24oe1xuICAgICAgICBleGNsdWRlRXh0ZXJuYWxzOiB0cnVlLFxuICAgICAgICBlbnRyeVBvaW50cyxcbiAgICAgICAgdHNjb25maWc6IHBrZy5yZXNvbHZlKFwidHNjb25maWcuanNvblwiKSxcbiAgICAgICAgYmFzZVBhdGgsXG4gICAgICAgIHNraXBFcnJvckNoZWNraW5nOiB0cnVlLFxuXG4gICAgICAgIC8vIFJlbW92ZXMgYSBjb3VwbGUgaHVuZHJlZCBNQiBvZiB0YWJzIHNvIHdvcnRoIHVuY29tbWVudGluZyBhdCBzb21lIHBvaW50XG4gICAgICAgIC8vcHJldHR5OiBmYWxzZSxcblxuICAgICAgICByZWFkbWU6IFwibm9uZVwiLFxuICAgIH0pO1xuXG4gICAgaW5zdHJ1bWVudEZvckVudHJ5cG9pbnRSZXBhaXIoYXBwLCBwa2cpO1xuXG4gICAgY29uc3QgYW5hbHlzaXMgPSBuZXcgUmVmbGVjdGlvbkFuYWx5c2lzKCk7XG5cbiAgICBhcHAuY29udmVydGVyLm9uKENvbnZlcnRlci5FVkVOVF9DUkVBVEVfREVDTEFSQVRJT04sICgvKl9jb250ZXh0LCByZWZsZWN0aW9uOiBEZWNsYXJhdGlvblJlZmxlY3Rpb24qLykgPT4ge1xuICAgICAgICBwcm9ncmVzcy5yZWZyZXNoKCk7XG4gICAgfSk7XG5cbiAgICBhcHAuY29udmVydGVyLm9uKENvbnZlcnRlci5FVkVOVF9SRVNPTFZFLCAoKSA9PiB7XG4gICAgICAgIHByb2dyZXNzLnJlZnJlc2goKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlZmxlY3Rpb24gPSBhd2FpdCBsb2FkUmVmbGVjdGlvbnMoYXBwLCBwa2cpO1xuXG4gICAgYW5hbHl6ZVJlZmxlY3Rpb25zKHJlZmxlY3Rpb24sIGFuYWx5c2lzKTtcbiAgICByZXBhaXJSZWZsZWN0aW9ucyhhbmFseXNpcyk7XG5cbiAgICBhd2FpdCBhcHAuZ2VuZXJhdGVKc29uKHJlZmxlY3Rpb24sIHBrZy5yZXNvbHZlKFwiYnVpbGQvZG9jcy5qc29uXCIpKTtcbn1cblxuZnVuY3Rpb24gcmVmbGVjdGlvbnNQYXRoKHBrZzogUGFja2FnZSkge1xuICAgIGNvbnN0IHBhdGggPSBwa2cucmVzb2x2ZShcImJ1aWxkL2RvY3MuanNvblwiKTtcbiAgICBpZiAoaXNGaWxlKHBhdGgpKSB7XG4gICAgICAgIHJldHVybiBwYXRoO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUeXBlZG9jIGlzIGluc3VmZmljaWVudGx5IGNvbmZpZ3VyYWJsZSB0byBjb3JyZWN0bHkgbmFtZSBtb2R1bGVzLiAgVGhlIG9mZmljaWFsIGRpcmVjdGlvbiBpcyB0byByZW5hbWUgbW9kdWxlcyB1c2luZ1xuICogdGhlIFwibW9kdWxlXCIgYW5ub3RhdGlvbiBidXQgc2VlbXMgZHVtYiB0byBoYXZlIHRvIGRvIHRoYXQgd2hlbiB3ZSBjYW4gY29tcHV0ZSB0aGUgY29ycmVjdCBuYW1lLiAgV2UnZCBoYXZlIHRvIGVkaXRcbiAqIGFuZCBtYWludGFpbiBtYW55IGZpbGVzIGluY2x1ZGluZyBjb2RlZ2VuLlxuICpcbiAqIEluc3RlYWQgd2UgY3JlYXRlIGEgbWFwIG9mIHR5cGVkb2MncyBuYWl2ZSBtb2R1bGUgbmFtZSB0byB0aGUgY29ycmVjdCBuYW1lIHNvIHdlIGNhbiB1cGRhdGUgbmFtZXMgYXMgcmVmbGVjdGlvbnNcbiAqIGxvYWQuXG4gKi9cbmZ1bmN0aW9uIGluc3RydW1lbnRGb3JFbnRyeXBvaW50UmVwYWlyKGFwcDogQXBwbGljYXRpb24sIHBrZzogUGFja2FnZSkge1xuICAgIGNvbnN0IGJhc2VHZXRFbnRyeVBvaW50cyA9IGFwcC5nZXRFbnRyeVBvaW50cy5iaW5kKGFwcCk7XG4gICAgY29uc3QgbWFwcGluZyA9IG5haXZlVG9SZWFsTmFtZXNGb3IocGtnKTtcbiAgICBhcHAuZ2V0RW50cnlQb2ludHMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGxpc3QgPSBiYXNlR2V0RW50cnlQb2ludHMoKTtcbiAgICAgICAgaWYgKGxpc3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGVwIG9mIGxpc3QpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlYWxOYW1lID0gbWFwcGluZ1tlcC5kaXNwbGF5TmFtZV07XG4gICAgICAgICAgICBpZiAocmVhbE5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVHlwZWRvYyBuYWl2ZSBtb2R1bGUgbmFtZSBcIiR7ZXAuZGlzcGxheU5hbWV9XCIgaXMgdW5tYXBwZWRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVwLmRpc3BsYXlOYW1lID0gcmVhbE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBCdWlsZCB0aGUgbWFwIG9mIHR5cGVkb2MncyBuYWl2ZSBuYW1lIC0+IHJlYWwgbmFtZS5cbiAqL1xuZnVuY3Rpb24gbmFpdmVUb1JlYWxOYW1lc0Zvcihwa2c6IFBhY2thZ2UpIHtcbiAgICBjb25zdCBtb2R1bGVzID0gcGtnLnNvdXJjZU1vZHVsZXM7XG5cbiAgICAvLyBNYXAgb2Ygc3R1cGlkIG5hbWVzIHRoYXQgdHlwZWRvYyBjaG9vc2VzIHRvIGFjdHVhbCBleHBvcnQgbmFtZXNcbiAgICBjb25zdCBtYXBwaW5nID0ge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICAgIGNvbnN0IHBhY2thZ2VQcmVmaXggPSBgJHtwa2cubmFtZX0vYDtcblxuICAgIC8vIEluIGEgd29ya3NwYWNlIHR5cGVkb2MgcmVxdWlyZXMgZmlsZXMgdG8gYmUgcmVsYXRpdmUgdG8gdGhlIHdvcmtzcGFjZSBmb3IgbWVyZ2VcbiAgICBjb25zdCBiYXNlUGF0aCA9IHBrZy5yb290LnBhdGg7XG5cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gbW9kdWxlcykge1xuICAgICAgICBjb25zdCBwYXRoID0gbW9kdWxlc1tuYW1lXTtcbiAgICAgICAgaWYgKHBhdGguZW5kc1dpdGgoXCIuanNvblwiKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBuYWl2ZU5hbWUgPSByZWxhdGl2ZShiYXNlUGF0aCwgcGF0aClcbiAgICAgICAgICAgIC5yZXBsYWNlKC8uKD86dHN8anN8bWpzfGNqcykkLywgXCJcIilcblxuICAgICAgICAgICAgLy8gdHlwZWRvYyBzdHJpcHMgXCIvaW5kZXhcIjsgdGhpcyBpcyBoYXJkLWNvZGVkIGFuZCBkb2Vzbid0IHJlc3BlY3QgZXhwb3J0c1xuICAgICAgICAgICAgLnJlcGxhY2UoL1xcL2luZGV4JC8sIFwiXCIpO1xuXG4gICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgocGFja2FnZVByZWZpeCkpIHtcbiAgICAgICAgICAgIG1hcHBpbmdbbmFpdmVOYW1lXSA9IG5hbWUuc3Vic3RyaW5nKHBhY2thZ2VQcmVmaXgubGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSBwa2cubmFtZSkge1xuICAgICAgICAgICAgLy8gRmxhZ3MgZm9yIG1lcmdlIHdpdGggcGFyZW50XG4gICAgICAgICAgICBtYXBwaW5nW25haXZlTmFtZV0gPSBcIi5cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hcHBpbmdbbmFpdmVOYW1lXSA9IG5hbWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbWFwcGluZztcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBzdGF0aWMgZG9jdW1lbnRhdGlvbiB3ZWJzaXRlLlxuICpcbiAqIFN1cHBvcnRzIGluZGl2aWR1YWwgcHJvamVjdHMgb3Igd29ya3NwYWNlcyBidXQgbm90IGluZGl2aWR1YWwgcHJvamVjdHMgd2l0aGluIHdvcmtzcGFjZXMuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtZXJnZURvY3MocGtnOiBQYWNrYWdlKSB7XG4gICAgY29uc3QgZW50cnlQb2ludHMgPSBBcnJheTxzdHJpbmc+KCk7XG5cbiAgICBjb25zdCByb290ID0gcGtnLnJvb3Q7XG5cbiAgICBpZiAocm9vdC5pc1dvcmtzcGFjZSkge1xuICAgICAgICAvLyBXb3Jrc3BhY2VcbiAgICAgICAgY29uc3QgZ3JhcGggPSBhd2FpdCBHcmFwaC5sb2FkKHJvb3QpO1xuICAgICAgICBpZiAoZ3JhcGggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gU2hvdWxkbid0IGhhcHBlblxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnRlcm5hbDogJHtwa2cubmFtZX0gaGFzIHdvcmtzcGFjZXMgYnV0IG5vIGdyYXBoYCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGdyYXBoLm5vZGVzKSB7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gcmVmbGVjdGlvbnNQYXRoKG5vZGUucGtnKTtcbiAgICAgICAgICAgIGlmIChwYXRoKSB7XG4gICAgICAgICAgICAgICAgZW50cnlQb2ludHMucHVzaChwYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWVudHJ5UG9pbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyByZWZsZWN0aW9ucyBkZXRlY3RlZCBpbiB3b3Jrc3BhY2UgJHtwa2cubmFtZX1gKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFN0YW5kYWxvbmUgcGFja2FnZVxuICAgICAgICBjb25zdCBwYXRoID0gcmVmbGVjdGlvbnNQYXRoKHBrZyk7XG4gICAgICAgIGlmIChwYXRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gcmVmbGVjdGlvbnMgcHJlc2VudCBmb3IgJHtwa2cubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBlbnRyeVBvaW50cy5wdXNoKHBhdGgpO1xuICAgIH1cblxuICAgIGNvbnN0IGFwcCA9IGF3YWl0IGNyZWF0ZUFwcGxpY2F0aW9uKHtcbiAgICAgICAgZW50cnlQb2ludHMsXG4gICAgICAgIGVudHJ5UG9pbnRTdHJhdGVneTogXCJtZXJnZVwiLFxuICAgICAgICAuLi5USEVNRV9PUFRJT05TLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVmbGVjdGlvbiA9IGF3YWl0IGxvYWRSZWZsZWN0aW9ucyhhcHAsIHBrZyk7XG5cbiAgICBhd2FpdCBhcHAuZ2VuZXJhdGVEb2NzKHJlZmxlY3Rpb24sIHBrZy5yZXNvbHZlKE9VVFBVVF9QQVRIKSk7XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdHlwZWRvYyBcImFwcGxpY2F0aW9uXCIgd2hpY2ggaXMgdGhlIGludGVyZmFjZSBmb3IgZXh0cmFjdGluZyB0eXBlcyBhbmQgZ2VuZXJhdGluZyBkb2NzLlxuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBcHBsaWNhdGlvbihvcHRpb25zOiBQYXJ0aWFsPFR5cGVEb2NPcHRpb25zPikge1xuICAgIHJldHVybiBhd2FpdCBBcHBsaWNhdGlvbi5ib290c3RyYXBXaXRoUGx1Z2lucyh7XG4gICAgICAgIHBsdWdpbjogUExVR0lOUyxcbiAgICAgICAgbG9nTGV2ZWw6IExvZ0xldmVsLldhcm4sXG4gICAgICAgIC4uLm9wdGlvbnMsXG4gICAgfSk7XG59XG5cbi8qKlxuICogUGVyZm9ybSBcImNvbnZlcnNpb25cIiB3aGljaCBpcyB0eXBlZG9jIHRlcm1pbm9sb2d5IGZvciBleGVjdXRpbmcgdGhlIG9wZXJhdGlvbiBkZWZpbmVkIGJ5IHRoZSBhcHBsaWNhdGlvbi5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gbG9hZFJlZmxlY3Rpb25zKGFwcDogQXBwbGljYXRpb24sIHBrZzogUGFja2FnZSkge1xuICAgIGNvbnN0IHJlZmxlY3Rpb24gPSBhd2FpdCBhcHAuY29udmVydCgpO1xuICAgIGlmIChyZWZsZWN0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQcm9qZWN0ICR7cGtnLnBhdGh9IHByb2R1Y2VkIG5vIGRvY3VtZW50YXRpb25gKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlZmxlY3Rpb247XG59XG5cbmNsYXNzIFJlZmxlY3Rpb25BbmFseXNpcyB7XG4gICAgLy8gVE9ETyAtIG5lZWQgdG8gcG9wdWxhdGUgdGhpcyBkdXJpbmcgYW5hbHlzaXMgc28gd2UgY2FuIHdhcm47IHdpbGwgcmVwbGFjZSB0eXBlZG9jLXBsdWdpbi1taXNzaW5nLWV4cG9ydHNcbiAgICB1bmV4cG9ydGVkUmVmZXJlbmNlID0gbmV3IFNldDxSZWZsZWN0aW9uPigpO1xuXG4gICAgbWVyZ2VXaXRoUGFyZW50ID0gbmV3IFNldDxEZWNsYXJhdGlvblJlZmxlY3Rpb24+KCk7XG4gICAgbWVyZ2VJbnRvID0gbmV3IE1hcDxEZWNsYXJhdGlvblJlZmxlY3Rpb24sIERlY2xhcmF0aW9uUmVmbGVjdGlvbj4oKTtcbn1cblxuLyoqXG4gKiBUcmFuc2Zvcm0gcmVmbGVjdGlvbnMgdG8gaW1wcm92ZSBmaW5hbCBvdXRwdXQuXG4gKi9cbmZ1bmN0aW9uIGFuYWx5emVSZWZsZWN0aW9ucyhub2RlOiBSZWZsZWN0aW9uLCBhbmFseXNpczogUmVmbGVjdGlvbkFuYWx5c2lzKSB7XG4gICAgdmlzaXQobm9kZSwgc3ViamVjdCA9PiB7XG4gICAgICAgIC8vIFRPRE8gLSBwb3B1bGF0ZSBhbmFseXNpcy51bmV4cG9yZWRSZWZlcmVuY2UgKG9yIHBlcmhhcHMganVzdCBwcmludCB3YXJuaW5nKVxuXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gY2hpbGRyZW5PZihzdWJqZWN0KTtcbiAgICAgICAgY29uc3QgbWVyZ2VhYmxlID0ge30gYXMgUmVjb3JkPHN0cmluZywgRGVjbGFyYXRpb25SZWZsZWN0aW9uPjtcbiAgICAgICAgY29uc3QgbmFtZXNwYWNlcyA9IG5ldyBTZXQ8RGVjbGFyYXRpb25SZWZsZWN0aW9uPigpO1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQua2luZE9mKFJlZmxlY3Rpb25LaW5kLkNsYXNzT3JJbnRlcmZhY2UgfCBSZWZsZWN0aW9uS2luZC5GdW5jdGlvbikpIHtcbiAgICAgICAgICAgICAgICBtZXJnZWFibGVbY2hpbGQubmFtZV0gPSBjaGlsZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGQua2luZE9mKFJlZmxlY3Rpb25LaW5kLk5hbWVzcGFjZSkpIHtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2VzLmFkZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG5zIG9mIG5hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlSW50byA9IG1lcmdlYWJsZVtucy5uYW1lXTtcbiAgICAgICAgICAgIGlmIChtZXJnZUludG8pIHtcbiAgICAgICAgICAgICAgICBhbmFseXNpcy5tZXJnZUludG8uc2V0KG5zLCBtZXJnZUludG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlcGFpclJlZmxlY3Rpb25zKGFuYWx5c2lzOiBSZWZsZWN0aW9uQW5hbHlzaXMpIHtcbiAgICBmb3IgKGNvbnN0IHRvTWVyZ2Ugb2YgYW5hbHlzaXMubWVyZ2VXaXRoUGFyZW50KSB7XG4gICAgICAgIGlmICh0b01lcmdlLnBhcmVudCBpbnN0YW5jZW9mIERlY2xhcmF0aW9uUmVmbGVjdGlvbikge1xuICAgICAgICAgICAgbWVyZ2VJbnRvKHRvTWVyZ2UsIHRvTWVyZ2UucGFyZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IFt0b01lcmdlLCBpbnRvXSBvZiBhbmFseXNpcy5tZXJnZUludG8uZW50cmllcygpKSB7XG4gICAgICAgIG1lcmdlSW50byh0b01lcmdlLCBpbnRvKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1vdmVOb2RlKHN1YmplY3Q6IERlY2xhcmF0aW9uUmVmbGVjdGlvbiwgaW50bzogQ29udGFpbmVyUmVmbGVjdGlvbikge1xuICAgIGNvbnN0IGZyb20gPSBzdWJqZWN0LnBhcmVudCBhcyBDb250YWluZXJSZWZsZWN0aW9uO1xuXG4gICAgLy8gTm8gYWN0dWFsIG1vdmVtZW50XG4gICAgaWYgKGZyb20gPT09IGludG8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBmcm9tIG9sZCBwYXJlbnRcbiAgICBpZiAoZnJvbSkge1xuICAgICAgICBmcm9tLnJlbW92ZUNoaWxkKHN1YmplY3QpO1xuICAgIH1cblxuICAgIC8vIEFkZCB0byBuZXcgcGFyZW50XG4gICAgaW50by5hZGRDaGlsZChzdWJqZWN0KTtcbiAgICBzdWJqZWN0LnBhcmVudCA9IGludG87XG5cbiAgICAvLyBXaGVuIG1lcmdpbmcgYSBuYW1lc3BhY2UgaW50byBhIHR5cGUgdHdlYWsgbW9kaWZpZXIgYW5kIGtpbmQgYXBwcm9wcmlhdGVseSAoYSBiaXQgb2YgZ3Vlc3NpbmcgaGVyZTsgbWlnaHQgbmVlZFxuICAgIC8vIHR3ZWFraW5nKVxuICAgIGlmIChcbiAgICAgICAgZnJvbS5raW5kT2YoUmVmbGVjdGlvbktpbmQuTmFtZXNwYWNlKSAmJlxuICAgICAgICBpbnRvLmtpbmRPZihSZWZsZWN0aW9uS2luZC5DbGFzc09ySW50ZXJmYWNlKSAmJlxuICAgICAgICBzdWJqZWN0LmtpbmRPZihSZWZsZWN0aW9uS2luZC5Tb21lVmFsdWUpXG4gICAgKSB7XG4gICAgICAgIHN1YmplY3QuZmxhZ3Muc2V0RmxhZyhSZWZsZWN0aW9uRmxhZy5TdGF0aWMsIHRydWUpO1xuICAgICAgICBpZiAoc3ViamVjdC5raW5kT2YoUmVmbGVjdGlvbktpbmQuVmFyaWFibGUpKSB7XG4gICAgICAgICAgICBzdWJqZWN0LmtpbmQgPSBSZWZsZWN0aW9uS2luZC5Qcm9wZXJ0eTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gbWVyZ2VJbnRvKGZyb206IERlY2xhcmF0aW9uUmVmbGVjdGlvbiwgaW50bzogQ29udGFpbmVyUmVmbGVjdGlvbikge1xuICAgIGNvbnN0IGNoaWxkcmVuID0gY2hpbGRyZW5PZihmcm9tKTtcbiAgICB3aGlsZSAoY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIG1vdmVOb2RlKGNoaWxkcmVuWzBdLCBpbnRvKTtcbiAgICB9XG4gICAgKGZyb20ucGFyZW50IGFzIENvbnRhaW5lclJlZmxlY3Rpb24pPy5yZW1vdmVDaGlsZChmcm9tKTtcbiAgICAvLyBUT0RPIC0gcmVtYXAgbmFtZVxufVxuXG5mdW5jdGlvbiBjaGlsZHJlbk9mKG5vZGU6IFJlZmxlY3Rpb24pIHtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIENvbnRhaW5lclJlZmxlY3Rpb24pIHtcbiAgICAgICAgaWYgKG5vZGUuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbm9kZS5jaGlsZHJlbiA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlLmNoaWxkcmVuO1xuICAgIH1cbiAgICByZXR1cm4gW107XG59XG5cbi8qKlxuICogVmlzaXQgYWxsIG5vZGVzIGluIGEgcmVmbGVjdGlvbiB0cmVlLiAgUmVmbGVjdGlvbiBoYXMgYSBcInZpc2l0XCIgbWV0aG9kIGJ1dCBpdCdzIGp1c3QgYSBicmFuY2ggb24gdHlwZS5cbiAqL1xuZnVuY3Rpb24gdmlzaXQobm9kZTogUmVmbGVjdGlvbiwgdmlzaXRvcjogKG5vZGU6IFJlZmxlY3Rpb24pID0+IHZvaWQpIHtcbiAgICB2aXNpdG9yKG5vZGUpO1xuXG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbk9mKG5vZGUpKSB7XG4gICAgICAgIHZpc2l0KGNoaWxkLCB2aXNpdG9yKTtcbiAgICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUEsU0FBUyxnQkFBZ0I7QUFDekI7QUFBQSxFQUNJO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBRUE7QUFBQSxFQUNBO0FBQUEsT0FFRztBQUNQLFNBQVMsY0FBYztBQUd2QixTQUFTLGFBQWE7QUFLdEIsTUFBTSxVQUFVLENBQUMsc0JBQXNCO0FBR3ZDLE1BQU0sY0FBYztBQUVwQixNQUFNLGdCQUFnQjtBQUFBLEVBQ2xCLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1oQjtBQUtBLGVBQXNCLFVBQVUsS0FBYyxVQUFvQjtBQUM5RCxRQUFNLFVBQVUsSUFBSTtBQUdwQixRQUFNLGNBQWMsTUFBYztBQUdsQyxRQUFNLFdBQVcsSUFBSSxLQUFLO0FBRTFCLGFBQVcsUUFBUSxTQUFTO0FBQ3hCLFVBQU0sT0FBTyxRQUFRLElBQUk7QUFDekIsUUFBSSxLQUFLLFNBQVMsT0FBTyxHQUFHO0FBQ3hCO0FBQUEsSUFDSjtBQUVBLFFBQUksT0FBTyxJQUFJLEdBQUc7QUFDZCxVQUFJLENBQUMsWUFBWSxTQUFTLElBQUksR0FBRztBQUM3QixvQkFBWSxLQUFLLElBQUk7QUFBQSxNQUN6QjtBQUFBLElBQ0osT0FBTztBQUNILFlBQU0sSUFBSSxNQUFNLDhCQUE4QixJQUFJLFNBQVMsUUFBUSxJQUFJLENBQUMsRUFBRTtBQUFBLElBQzlFO0FBQUEsRUFDSjtBQUVBLFFBQU0sTUFBTSxNQUFNLGtCQUFrQjtBQUFBLElBQ2hDLGtCQUFrQjtBQUFB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O0FBQUEsTUFDNUIsV0FBVyxNQUFNLE9BQU8sZUFBZSxTQUFTLEdBQUc7QUFDL0MsbUJBQVcsSUFBSSxLQUFLO0FBQUEsTUFDeEI7QUFBQSxJQUNKO0FBRUEsZUFBVyxNQUFNLFlBQVk7QUFDekIsWUFBTUEsYUFBWSxVQUFVLEdBQUcsSUFBSTtBQUNuQyxVQUFJQSxZQUFXO0FBQ1gsaUJBQVMsVUFBVSxJQUFJLElBQUlBLFVBQVM7QUFBQSxNQUN4QztBQUFBLElBQ0o7QUFBQSxFQUNKLENBQUM7QUFDTDtBQUVBLFNBQVMsa0JBQWtCLFVBQThCO0FBQ3JELGFBQVcsV0FBVyxTQUFTLGlCQUFpQjtBQUM1QyxRQUFJLFFBQVEsa0JBQWtCLHVCQUF1QjtBQUNqRCxnQkFBVSxTQUFTLFFBQVEsTUFBTTtBQUFBLElBQ3JDO0FBQUEsRUFDSjtBQUNBLGFBQVcsQ0FBQyxTQUFTLElBQUksS0FBSyxTQUFTLFVBQVUsUUFBUSxHQUFHO0FBQ3hELGNBQVUsU0FBUyxJQUFJO0FBQUEsRUFDM0I7QUFDSjtBQUVBLFNBQVMsU0FBUyxTQUFnQyxNQUEyQjtBQUN6RSxRQUFNLE9BQU8sUUFBUTtBQUdyQixNQUFJLFNBQVMsTUFBTTtBQUNmO0FBQUEsRUFDSjtBQUdBLE1BQUksTUFBTTtBQUNOLFNBQUssWUFBWSxPQUFPO0FBQUEsRUFDNUI7QUFHQSxPQUFLLFNBQVMsT0FBTztBQUNyQixVQUFRLFNBQVM7QUFJakIsTUFDSSxLQUFLLE9BQU8sZUFBZSxTQUFTLEtBQ3BDLEtBQUssT0FBTyxlQUFlLGdCQUFnQixLQUMzQyxRQUFRLE9BQU8sZUFBZSxTQUFTLEdBQ3pDO0FBQ0UsWUFBUSxNQUFNLFFBQVEsZUFBZSxRQUFRLElBQUk7QUFDakQsUUFBSSxRQUFRLE9BQU8sZUFBZSxRQUFRLEdBQUc7QUFDekMsY0FBUSxPQUFPLGVBQWU7QUFBQSxJQUNsQztBQUFBLEVBQ0o7QUFDSjtBQUVBLFNBQVMsVUFBVSxNQUE2QixNQUEyQjtBQUN2RSxRQUFNLFdBQVcsV0FBVyxJQUFJO0FBQ2hDLFNBQU8sU0FBUyxRQUFRO0FBQ3BCLGFBQVMsU0FBUyxDQUFDLEdBQUcsSUFBSTtBQUFBLEVBQzlCO0FBQ0EsRUFBQyxLQUFLLFFBQWdDLFlBQVksSUFBSTtBQUUxRDtBQUVBLFNBQVMsV0FBVyxNQUFrQjtBQUNsQyxNQUFJLGdCQUFnQixxQkFBcUI7QUFDckMsUUFBSSxLQUFLLGFBQWEsUUFBVztBQUM3QixXQUFLLFdBQVcsQ0FBQztBQUFBLElBQ3JCO0FBQ0EsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFDQSxTQUFPLENBQUM7QUFDWjtBQUtBLFNBQVMsTUFBTSxNQUFrQixTQUFxQztBQUNsRSxVQUFRLElBQUk7QUFFWixhQUFXLFNBQVMsV0FBVyxJQUFJLEdBQUc7QUFDbEMsVUFBTSxPQUFPLE9BQU87QUFBQSxFQUN4QjtBQUNKOyIsCiAgIm5hbWVzIjogWyJtZXJnZUludG8iXQp9Cg==
