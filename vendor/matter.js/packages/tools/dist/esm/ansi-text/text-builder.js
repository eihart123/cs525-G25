/**
 * @license
 * Copyright 2022-2025 Matter.js Authors
 * SPDX-License-Identifier: Apache-2.0
 */
import { Producer } from "./producer.js";
import {
  Color,
  ExtendedColor,
  SgrOpcode,
  SgrOpcodeBlock,
  SgrOpcodeToUndoOpcode
} from "./sgr.js";
import { Style } from "./style.js";
import { TextWriter } from "./text-writer.js";
function TextBuilder(definition, derivesFrom, state) {
  if (derivesFrom instanceof TextBuilder) {
    state = { ...derivesFrom.state, ...state };
  } else if (state === void 0) {
    state = {};
  }
  definition = Style.definitionOf(definition);
  const self = function TextBuilderInstance(...text) {
    const sequence = self.state.sequence ? [...self.state.sequence] : [];
    if (self.styleDefinition?.length) {
      sequence.push(self.styleToken);
    }
    sequence.push(...text);
    return TextBuilder(self, self, { sequence, revert: true });
  };
  Object.setPrototypeOf(self, TextBuilder.prototype);
  self.state = state;
  if (definition !== void 0) {
    self.styleDefinition = definition;
  }
  return self;
}
TextBuilder.prototype = Object.create(Style.prototype, {
  bg: chmode({ bg: true }),
  not: chmode({ not: true }),
  bold: toggle("bold"),
  dim: toggle("dim"),
  bright: chmode({ bright: true }),
  italic: toggle("italic"),
  underline: toggle("underline"),
  doubleUnderline: toggle("doubleUnderline"),
  slowBlink: toggle("slowBlink"),
  fastBlink: toggle("fastBlink"),
  invert: toggle("invert"),
  conceal: toggle("conceal"),
  strike: toggle("strike"),
  black: color("black"),
  red: color("red"),
  green: color("green"),
  yellow: color("yellow"),
  blue: color("blue"),
  magenta: color("magenta"),
  cyan: color("cyan"),
  white: color("white"),
  reset: {
    get() {
      return this.addStyle([0]);
    }
  },
  color: {
    value(color2) {
      if (this.state.not) {
        return this.addStyle([this.state.bg ? SgrOpcode.normalBg : SgrOpcode.normalFg]);
      }
      if (typeof color2 === "object") {
        if ("color" in color2) {
          return this.addStyle([Color.extended, ExtendedColor.eightBit, color2.color]);
        }
        return this.addStyle([Color.extended, ExtendedColor.rgb, color2.r ?? 0, color2.g ?? 0, color2.b ?? 0]);
      }
      const block = this.state.bg ? this.state.bright ? SgrOpcodeBlock.bgBright : SgrOpcodeBlock.bg : this.state.bright ? SgrOpcodeBlock.fgBright : SgrOpcodeBlock.fg;
      return this.addStyle([block + color2]);
    }
  },
  toString: {
    value() {
      let { sequence } = this.state;
      if (!sequence) {
        sequence = [this.styleToken];
      }
      if (this.state.revert) {
        sequence = [...sequence, this.undoStyle.styleToken];
      }
      const parts = Array();
      const writer = new TextWriter((part) => parts.push(part));
      writer.write(...sequence);
      writer.close();
      return parts.join("");
    }
  },
  [Symbol.iterator]: {
    get() {
      if (this.state.sequence === void 0) {
        return {
          next() {
            return void 0;
          },
          done: true
        };
      }
      let sequence = this.state.sequence;
      if (this.state.revert) {
        sequence = [...sequence, this.undoStyle.styleToken];
      }
      const iterable = Producer.of(sequence);
      return iterable[Symbol.iterator].bind(iterable);
    }
  },
  factory: {
    value: TextBuilder
  }
});
function chmode(state) {
  return {
    get() {
      return TextBuilder(this, this, state);
    }
  };
}
function toggle(name) {
  const on = SgrOpcode[name];
  const off = SgrOpcodeToUndoOpcode[on];
  if (off === void 0) {
    throw new Error(`Can't toggle opcode ${on}`);
  }
  return {
    get() {
      return this.addStyle([this.state.not ? off : on]);
    }
  };
}
function color(color2) {
  const opcode = Color[color2];
  return {
    get() {
      return this.color(opcode);
    }
  };
}
const ansi = TextBuilder();
export {
  TextBuilder,
  ansi
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL2Fuc2ktdGV4dC90ZXh0LWJ1aWxkZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyLTIwMjUgTWF0dGVyLmpzIEF1dGhvcnNcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHsgUHJvZHVjZXIgfSBmcm9tIFwiLi9wcm9kdWNlci5qc1wiO1xuaW1wb3J0IHtcbiAgICBDb2xvcixcbiAgICBFaWdodEJpdENvbG9yLFxuICAgIEV4dGVuZGVkQ29sb3IsXG4gICAgUmdiQ29sb3IsXG4gICAgU2dyT3Bjb2RlLFxuICAgIFNnck9wY29kZUJsb2NrLFxuICAgIFNnck9wY29kZVRvVW5kb09wY29kZSxcbn0gZnJvbSBcIi4vc2dyLmpzXCI7XG5pbXBvcnQgeyBTdHlsZSB9IGZyb20gXCIuL3N0eWxlLmpzXCI7XG5pbXBvcnQgeyBUZXh0V3JpdGVyIH0gZnJvbSBcIi4vdGV4dC13cml0ZXIuanNcIjtcblxuLyoqXG4gKiBDb252ZW5pZW5jZSBBUEkgZm9yIGJ1aWxkaW5nIEFOU0kgdGV4dC5cbiAqXG4gKiBBbGxvd3MgeW91IHRvIGNyZWF0ZSBBTlNJIGVzY2FwZSBzZXF1ZW5jZXMgdXNpbmcgZS5nLiBgYW5zaS5icmlnaHQueWVsbG93LmJnLmJsdWUuYmxpbmtgLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRleHRCdWlsZGVyIGV4dGVuZHMgU3R5bGUge1xuICAgICguLi50ZXh0OiBQcm9kdWNlci5TZXF1ZW5jZSk6IFRleHRCdWlsZGVyO1xuXG4gICAgcmVhZG9ubHkgc3RhdGU6IFRleHRCdWlsZGVyLlN0YXRlO1xuICAgIHJlYWRvbmx5IGJnOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSBub3Q6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IHJlc2V0OiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSBib2xkOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSBkaW06IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGJyaWdodDogVGV4dEJ1aWxkZXI7XG4gICAgcmVhZG9ubHkgaXRhbGljOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSB1bmRlcmxpbmU6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGRvdWJsZVVuZGVybGluZTogVGV4dEJ1aWxkZXI7XG4gICAgcmVhZG9ubHkgYmxpbms6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGZhc3RCbGluazogVGV4dEJ1aWxkZXI7XG4gICAgcmVhZG9ubHkgaW52ZXJ0OiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSBjb25jZWFsOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSBzdHJpa2U6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGJsYWNrOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSByZWQ6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGdyZWVuOiBUZXh0QnVpbGRlcjtcbiAgICByZWFkb25seSB5ZWxsb3c6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGJsdWU6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IG1hZ2VudGE6IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IGN5YW46IFRleHRCdWlsZGVyO1xuICAgIHJlYWRvbmx5IHdoaXRlOiBUZXh0QnVpbGRlcjtcbiAgICBjb2xvcihjb2xvcjogQ29sb3IgfCBFaWdodEJpdENvbG9yIHwgUmdiQ29sb3IpOiBUZXh0QnVpbGRlcjtcblxuICAgIGZhY3Rvcnk6IFRleHRCdWlsZGVyLkZhY3Rvcnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBUZXh0QnVpbGRlcihcbiAgICBkZWZpbml0aW9uPzogU3R5bGUuSW5wdXREZWZpbml0aW9uIHwgU3R5bGUsXG4gICAgZGVyaXZlc0Zyb20/OiBTdHlsZSxcbiAgICBzdGF0ZT86IFRleHRCdWlsZGVyLlN0YXRlLFxuKSB7XG4gICAgaWYgKGRlcml2ZXNGcm9tIGluc3RhbmNlb2YgVGV4dEJ1aWxkZXIpIHtcbiAgICAgICAgc3RhdGUgPSB7IC4uLihkZXJpdmVzRnJvbSBhcyBUZXh0QnVpbGRlcikuc3RhdGUsIC4uLnN0YXRlIH07XG4gICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHN0YXRlID0ge307XG4gICAgfVxuXG4gICAgZGVmaW5pdGlvbiA9IFN0eWxlLmRlZmluaXRpb25PZihkZWZpbml0aW9uKTtcblxuICAgIGNvbnN0IHNlbGYgPSBmdW5jdGlvbiBUZXh0QnVpbGRlckluc3RhbmNlKC4uLnRleHQ6IFByb2R1Y2VyLlNlcXVlbmNlKSB7XG4gICAgICAgIGNvbnN0IHNlcXVlbmNlID0gc2VsZi5zdGF0ZS5zZXF1ZW5jZSA/IFsuLi5zZWxmLnN0YXRlLnNlcXVlbmNlXSA6IFtdO1xuICAgICAgICBpZiAoc2VsZi5zdHlsZURlZmluaXRpb24/Lmxlbmd0aCkge1xuICAgICAgICAgICAgc2VxdWVuY2UucHVzaChzZWxmLnN0eWxlVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIHNlcXVlbmNlLnB1c2goLi4udGV4dCk7XG4gICAgICAgIHJldHVybiBUZXh0QnVpbGRlcihzZWxmLCBzZWxmLCB7IHNlcXVlbmNlLCByZXZlcnQ6IHRydWUgfSk7XG4gICAgfSBhcyBUZXh0QnVpbGRlcjtcblxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihzZWxmLCBUZXh0QnVpbGRlci5wcm90b3R5cGUpO1xuXG4gICAgKHNlbGYgYXMgYW55KS5zdGF0ZSA9IHN0YXRlO1xuXG4gICAgaWYgKGRlZmluaXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzZWxmLnN0eWxlRGVmaW5pdGlvbiA9IGRlZmluaXRpb247XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlbGY7XG59XG5cblRleHRCdWlsZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU3R5bGUucHJvdG90eXBlLCB7XG4gICAgYmc6IGNobW9kZSh7IGJnOiB0cnVlIH0pLFxuICAgIG5vdDogY2htb2RlKHsgbm90OiB0cnVlIH0pLFxuICAgIGJvbGQ6IHRvZ2dsZShcImJvbGRcIiksXG4gICAgZGltOiB0b2dnbGUoXCJkaW1cIiksXG4gICAgYnJpZ2h0OiBjaG1vZGUoeyBicmlnaHQ6IHRydWUgfSksXG4gICAgaXRhbGljOiB0b2dnbGUoXCJpdGFsaWNcIiksXG4gICAgdW5kZXJsaW5lOiB0b2dnbGUoXCJ1bmRlcmxpbmVcIiksXG4gICAgZG91YmxlVW5kZXJsaW5lOiB0b2dnbGUoXCJkb3VibGVVbmRlcmxpbmVcIiksXG4gICAgc2xvd0JsaW5rOiB0b2dnbGUoXCJzbG93QmxpbmtcIiksXG4gICAgZmFzdEJsaW5rOiB0b2dnbGUoXCJmYXN0QmxpbmtcIiksXG4gICAgaW52ZXJ0OiB0b2dnbGUoXCJpbnZlcnRcIiksXG4gICAgY29uY2VhbDogdG9nZ2xlKFwiY29uY2VhbFwiKSxcbiAgICBzdHJpa2U6IHRvZ2dsZShcInN0cmlrZVwiKSxcbiAgICBibGFjazogY29sb3IoXCJibGFja1wiKSxcbiAgICByZWQ6IGNvbG9yKFwicmVkXCIpLFxuICAgIGdyZWVuOiBjb2xvcihcImdyZWVuXCIpLFxuICAgIHllbGxvdzogY29sb3IoXCJ5ZWxsb3dcIiksXG4gICAgYmx1ZTogY29sb3IoXCJibHVlXCIpLFxuICAgIG1hZ2VudGE6IGNvbG9yKFwibWFnZW50YVwiKSxcbiAgICBjeWFuOiBjb2xvcihcImN5YW5cIiksXG4gICAgd2hpdGU6IGNvbG9yKFwid2hpdGVcIiksXG5cbiAgICByZXNldDoge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMgYXMgVGV4dEJ1aWxkZXIpLmFkZFN0eWxlKFswXSk7XG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIGNvbG9yOiB7XG4gICAgICAgIHZhbHVlKHRoaXM6IFRleHRCdWlsZGVyLCBjb2xvcjogQ29sb3IgfCBFaWdodEJpdENvbG9yIHwgUmdiQ29sb3IpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLm5vdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZFN0eWxlKFt0aGlzLnN0YXRlLmJnID8gU2dyT3Bjb2RlLm5vcm1hbEJnIDogU2dyT3Bjb2RlLm5vcm1hbEZnXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJjb2xvclwiIGluIGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZFN0eWxlKFtDb2xvci5leHRlbmRlZCwgRXh0ZW5kZWRDb2xvci5laWdodEJpdCwgY29sb3IuY29sb3JdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkU3R5bGUoW0NvbG9yLmV4dGVuZGVkLCBFeHRlbmRlZENvbG9yLnJnYiwgY29sb3IuciA/PyAwLCBjb2xvci5nID8/IDAsIGNvbG9yLmIgPz8gMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBibG9jayA9IHRoaXMuc3RhdGUuYmdcbiAgICAgICAgICAgICAgICA/IHRoaXMuc3RhdGUuYnJpZ2h0XG4gICAgICAgICAgICAgICAgICAgID8gU2dyT3Bjb2RlQmxvY2suYmdCcmlnaHRcbiAgICAgICAgICAgICAgICAgICAgOiBTZ3JPcGNvZGVCbG9jay5iZ1xuICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZS5icmlnaHRcbiAgICAgICAgICAgICAgICAgID8gU2dyT3Bjb2RlQmxvY2suZmdCcmlnaHRcbiAgICAgICAgICAgICAgICAgIDogU2dyT3Bjb2RlQmxvY2suZmc7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZFN0eWxlKFtibG9jayArIGNvbG9yXSk7XG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIHRvU3RyaW5nOiB7XG4gICAgICAgIHZhbHVlKHRoaXM6IFRleHRCdWlsZGVyKSB7XG4gICAgICAgICAgICBsZXQgeyBzZXF1ZW5jZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgICAgIGlmICghc2VxdWVuY2UpIHtcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZSA9IFt0aGlzLnN0eWxlVG9rZW5dO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5yZXZlcnQpIHtcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZSA9IFsuLi5zZXF1ZW5jZSwgdGhpcy51bmRvU3R5bGUuc3R5bGVUb2tlbl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gQXJyYXk8c3RyaW5nPigpO1xuXG4gICAgICAgICAgICBjb25zdCB3cml0ZXIgPSBuZXcgVGV4dFdyaXRlcihwYXJ0ID0+IHBhcnRzLnB1c2gocGFydCkpO1xuICAgICAgICAgICAgd3JpdGVyLndyaXRlKC4uLnNlcXVlbmNlKTtcbiAgICAgICAgICAgIHdyaXRlci5jbG9zZSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbihcIlwiKTtcbiAgICAgICAgfSxcbiAgICB9LFxuXG4gICAgW1N5bWJvbC5pdGVyYXRvcl06IHtcbiAgICAgICAgZ2V0KHRoaXM6IFRleHRCdWlsZGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5zZXF1ZW5jZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgZG9uZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHNlcXVlbmNlID0gdGhpcy5zdGF0ZS5zZXF1ZW5jZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLnJldmVydCkge1xuICAgICAgICAgICAgICAgIHNlcXVlbmNlID0gWy4uLnNlcXVlbmNlLCB0aGlzLnVuZG9TdHlsZS5zdHlsZVRva2VuXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGl0ZXJhYmxlID0gUHJvZHVjZXIub2Yoc2VxdWVuY2UpO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZXJhYmxlW1N5bWJvbC5pdGVyYXRvcl0uYmluZChpdGVyYWJsZSk7XG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIGZhY3Rvcnk6IHtcbiAgICAgICAgdmFsdWU6IFRleHRCdWlsZGVyLFxuICAgIH0sXG59KTtcblxuZnVuY3Rpb24gY2htb2RlKHN0YXRlPzogVGV4dEJ1aWxkZXIuU3RhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBnZXQodGhpczogVGV4dEJ1aWxkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBUZXh0QnVpbGRlcih0aGlzLCB0aGlzLCBzdGF0ZSk7XG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlKG5hbWU6IGtleW9mIHR5cGVvZiBTZ3JPcGNvZGUpIHtcbiAgICBjb25zdCBvbiA9IFNnck9wY29kZVtuYW1lXTtcbiAgICBjb25zdCBvZmYgPSBTZ3JPcGNvZGVUb1VuZG9PcGNvZGVbb25dO1xuICAgIGlmIChvZmYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IHRvZ2dsZSBvcGNvZGUgJHtvbn1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXQodGhpczogVGV4dEJ1aWxkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZFN0eWxlKFt0aGlzLnN0YXRlLm5vdCA/IG9mZiA6IG9uXSk7XG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gY29sb3IoY29sb3I6IGtleW9mIHR5cGVvZiBDb2xvcikge1xuICAgIGNvbnN0IG9wY29kZSA9IENvbG9yW2NvbG9yXTtcbiAgICByZXR1cm4ge1xuICAgICAgICBnZXQodGhpczogVGV4dEJ1aWxkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbG9yKG9wY29kZSk7XG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBUZXh0QnVpbGRlciB7XG4gICAgZXhwb3J0IGludGVyZmFjZSBTdGF0ZSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBuZXh0IGJ1aWxkIGFmZmVjdHMgYSBjb2xvciBpdCB3aWxsIG1vZGlmeSBiZyByYXRoZXIgdGhhbiBmZy5cbiAgICAgICAgICovXG4gICAgICAgIHJlYWRvbmx5IGJnPzogYm9vbGVhbjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgbmV4dCBidWlsZCBhZmZlY3RzIDgtYml0IGNvbG9yIHRoZSBjb2xvciB3aWxsIHJlbmRlciBhcyBicmlnaHQuXG4gICAgICAgICAqL1xuICAgICAgICByZWFkb25seSBicmlnaHQ/OiBib29sZWFuO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBuZXh0IGJ1aWxkIG1vZGlmaWVzIEFOU0kgc3R5bGluZyBpdHMgbWVhbmluZyBpcyBpbnZlcnRlZC5cbiAgICAgICAgICovXG4gICAgICAgIHJlYWRvbmx5IG5vdD86IGJvb2xlYW47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlcmlhbGl6YXRpb24gd2lsbCBpbmNsdWRlIHN0eWxlIHJldmVyc2lvbiBhcyB0aGUgZmluYWwgdG9rZW4uXG4gICAgICAgICAqXG4gICAgICAgICAqIFNldCBhZnRlciBpbnZva2luZyBidWlsZGVyIGFzIGZ1bmN0aW9uLCBjbGVhcmVkIHdoZW4gbW9kaWZ5aW5nIHN0eWxlLiAgVGhpcyBtZWFucyB0aGF0IGFuc2kucmVkKFwiZm9vXCIpIGlzXG4gICAgICAgICAqIHRlcm1pbmF0ZWQgYnV0IGFuc2kucmVkKFwiZm9vXCIpLmdyZWVuIHdpbGwgcmVuZGVyIGFzIGEgcmVkIFwiZm9vXCIgYW5kIGxlYXZlIHRleHQgc3R5bGVkIGdyZWVuLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVhZG9ubHkgcmV2ZXJ0PzogYm9vbGVhbjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNlcmlhbGl6YXRpb24gc2VxdWVuY2UuICBQb3B1bGF0ZWQgYnkgaW52b2tpbmcgYnVpbGRlciBhcyBmdW5jdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHJlYWRvbmx5IHNlcXVlbmNlPzogUHJvZHVjZXIuU2VxdWVuY2U7XG4gICAgfVxuXG4gICAgZXhwb3J0IHR5cGUgRmFjdG9yeSA9IChcbiAgICAgICAgZGVmaW5pdGlvbj86IFN0eWxlLkRlZmluaXRpb24gfCBTdHlsZSxcbiAgICAgICAgZGVyaXZlc0Zyb20/OiBTdHlsZSxcbiAgICAgICAgc3RhdGU/OiBUZXh0QnVpbGRlci5TdGF0ZSxcbiAgICApID0+IFRleHRCdWlsZGVyO1xufVxuXG4vKipcbiAqIEluaXRpYWwgYnVpbGRlci5cbiAqL1xuZXhwb3J0IGNvbnN0IGFuc2kgPSBUZXh0QnVpbGRlcigpO1xuIl0sCiAgIm1hcHBpbmdzIjogIkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1BLFNBQVMsZ0JBQWdCO0FBQ3pCO0FBQUEsRUFDSTtBQUFBLEVBRUE7QUFBQSxFQUVBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxPQUNHO0FBQ1AsU0FBUyxhQUFhO0FBQ3RCLFNBQVMsa0JBQWtCO0FBc0NwQixTQUFTLFlBQ1osWUFDQSxhQUNBLE9BQ0Y7QUFDRSxNQUFJLHVCQUF1QixhQUFhO0FBQ3BDLFlBQVEsRUFBRSxHQUFJLFlBQTRCLE9BQU8sR0FBRyxNQUFNO0FBQUEsRUFDOUQsV0FBVyxVQUFVLFFBQVc7QUFDNUIsWUFBUSxDQUFDO0FBQUEsRUFDYjtBQUVBLGVBQWEsTUFBTSxhQUFhLFVBQVU7QUFFMUMsUUFBTSxPQUFPLFNBQVMsdUJBQXVCLE1BQXlCO0FBQ2xFLFVBQU0sV0FBVyxLQUFLLE1BQU0sV0FBVyxDQUFDLEdBQUcsS0FBSyxNQUFNLFFBQVEsSUFBSSxD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
